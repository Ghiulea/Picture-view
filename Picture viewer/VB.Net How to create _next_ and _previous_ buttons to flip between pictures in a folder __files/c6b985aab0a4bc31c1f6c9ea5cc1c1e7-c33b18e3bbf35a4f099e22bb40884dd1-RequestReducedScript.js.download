function limitFocusInDialog(n,t){$("body").on("keydown",t,function(t){var i=t.keyCode||t.which;t.shiftKey||i!=9||($(n).focus(),t.preventDefault&&t.preventDefault())});$("body").on("keydown",n,function(n){var i=n.keyCode||n.which;n.shiftKey&&i==9&&($(t).focus(),n.preventDefault&&n.preventDefault())})}function limitFocusIfNoPop(n,t){$("body").on("keydown",t,function(i){var r=i.keyCode||i.which;i.shiftKey||r!=9||$(t).children(".popup").is(":visible")||($(n).focus(),i.preventDefault&&i.preventDefault())});$("body").on("keydown",n,function(n){var i=n.keyCode||n.which;n.shiftKey&&i==9&&!$(t).children(".popup").is(":visible")&&($(t).focus(),n.preventDefault&&n.preventDefault())})}function focusOnFirstElementByXPath(n){$(n).length>0&&$(n).first().focus()}function addSkipNavigationButton(){$("#ux-header header div.top .left").append("<a id='SkipNavigation' aria-label='Skip navigation' role='button' href='javascript:void(0)'>Skip navigation</a>");$("body").on("keydown","#ux-header header div.top .left a.DevCenterFullNameNonMegaBlade",function(n){n.shiftKey||n.which!=9||(n.preventDefault&&n.preventDefault(),$("a#SkipNavigation").show(),$("a#SkipNavigation").focus())});if($("#ux-header header div.top .right a.createProfileLink").attr("href"))$("body").on("keydown","#ux-header header div.top .right a.createProfileLink",function(n){n.shiftKey&&n.which==9&&(n.preventDefault&&n.preventDefault(),$("a#SkipNavigation").show(),$("a#SkipNavigation").focus())});else $("body").on("keydown","#ux-header header div.top .right a.scarabLink",function(n){n.shiftKey&&n.which==9&&(n.preventDefault&&n.preventDefault(),$("a#SkipNavigation").show(),$("a#SkipNavigation").focus())});$("body").on("keydown","#ux-header header div.top .left a#SkipNavigation",function(n){n.which==9?$("a#SkipNavigation").hide():n.which==13&&(n.preventDefault&&n.preventDefault(),focusOnFirstElementByXPath("#homePageContentContainer #searchContent #allThreadsContainer #homePageResultsContainer ul#threadList li.threadblock:first .threadsnippet .details .detailscontainer h3 a.threadUrl"),$("a#SkipNavigation").hide())})}function ReadCookie(n,t){var i,r;return(t||(t=";"),document.cookie.length<1)?"":(i=document.cookie.indexOf(n+"="),i<0)?"":(r=document.cookie.indexOf(t,i),unescape(document.cookie.substring(i+n.length+1,r<0?document.cookie.length:r)))}function ReadCommunityInfo(n){var t,u=document.getElementsByName("CommunityInfo"),i,r;return(t=!u||u.length<1?"":u[0].content,i=t.indexOf(n+"="),i<0)?"":(r=t.indexOf(";",i),unescape(t.substring(i+n.length+1,r<0?t.length:r)))}function GetCurrentBrand(){return ReadCommunityInfo("B")}function GetCurrentLocale(){return ReadCommunityInfo("L")}function GetCurrentAppName(){return ReadCommunityInfo("A")}function TrackEvent(n,t,i,r,u,f){var c=2147483647,a="_TRK_U_8934",l="http://c.microsoft.com/trans_pixel.aspx?TYPE=SSPV&GUID=1F4FC18C-F71E-47fb-8FC9-612F8EE59C61",h,e,o,s;if(i||(i=GetCurrentAppName()),r||(r=GetCurrentBrand()),h="&r="+escape(window.location)+"&rnd="+Math.floor(Math.random()*c+1)+"&URI=",e="/eventtrack/?app="+i+"&event="+n+"&brand="+r,e+="&locale="+(u?u:GetCurrentLocale()),f?e+="&userID="+f+"&signedIn=1":(f=ReadCookie("muid","&"),f&&(e+="&userID="+f+"&signedIn=1")),t&&typeof t=="object")for(o in t)e+="&"+o+"="+t[o];s=l+h+escape(e),document.images?(eventImgs[eventImgIdx]=new Image,eventImgs[eventImgIdx].src=s,eventImgIdx++):document.write('<img border="0" width="1" height="1" src="'+s+'"/>')}function loadJavaScript(n){var i=document.createElement("script"),t;i.src=n,t=document.getElementsByTagName("head")[0],t.appendChild(i)}function loadDeferedJavaScript(n){$(window).load(function(){setTimeout(function(){loadJS(n)},1)})}$(document).ready(function(){limitFocusInDialog("#boxes #dialog .textSpan #reason","#boxes #dialog .buttonSpan #cancelButton"),limitFocusInDialog("#categoryFilterSection #categoryFilter #allCategoryPopupContainer #categoryPopupClose a#closeAllCategoryPopup","#categoryFilterSection #categoryFilter #allCategoryPopupContainer #forumDetailsContainer a#submitAllCategories"),limitFocusInDialog("#migrateAnnouncementPopup #closeMigratePopup","#migrateAnnouncementPopup .footer a.QAlink"),focusOnFirstElementByXPath("#homePageContentContainer #searchContent #allThreadsContainer #homePageResultsContainer ul#threadList li.threadblock:first .threadsnippet .details .detailscontainer h3 a.threadUrl");$("body").on("keyup","#quickLinks",function(n){n.which==27&&$("#quickLinks").children(".popup").is(":visible")&&($("#quickLinks").click(),$("#quickLinks").focus())});$("body").on("keyup",".messageContentContainer .messageContent .messageFooter .actions .abusive",function(n){n.which==27&&($(this).find("ul").first().hide(),$(this).find("a").first().attr("aria-expanded","false"),$(this).find("a").first().focus())});$("body").on("keyup","#boxes #dialog",function(n){n.which==27&&$("#cancelButton").click()});$("body").on("keydown","#quickLinks a:last",function(n){n.which==9&&($("#quickLinks").click(),$("#quickLinks").focus())});$("body").on("keydown",".messageContentContainer .messageContent .messageFooter .actions .abusive ul.popup li:last-child a",function(n){n.which==9&&($(this).parents("ul.popup").first().hide(),$(this).parents("ul.popup").first().prev().attr("aria-expanded","false"),$(this).parents("ul.popup").first().prev().focus())});$("body").on("keydown",".messageContentContainer .messageContent .messageFooter .actions .abusive ul.popup a",function(n){n.which==13&&($(this).parents("ul.popup").first().hide(),$(this).parents("ul.popup").first().prev().attr("aria-expanded","false"))});$("body").on("keydown",".threadsnippet .arrowoutercontainer .arrowcontainer a.arrowdown.visible",function(n){n.which==13&&$(this).click()});$("body").on("keydown",".messageContentContainer .messageContent .messageFooter .actions .abusive a.popup",function(n){n.which==13&&$(this).next().is(":visible")&&($(this).next().hide(),$(this).attr("aria-expanded","false"),$(this).focus(),n.preventDefault&&n.preventDefault())});$("body").on("keydown","#threadFilter",function(n){n.which==27&&$("#threadFilter").children(".popup").is(":visible")&&($("#threadFilter").click(),$("#threadFilter").focus())});$("body").on("keydown","#threadFilter input:last",function(n){n.which==9&&($("#threadFilter").click(),$("#threadFilter").focus())});$("body").on("keydown","#sortFilter",function(n){n.which==27&&$("#sortFilter").children(".popup").is(":visible")&&($("#sortFilter").click(),$("#sortFilter").focus())});$("body").on("keydown","#sortFilter li:last",function(n){n.which==9&&($("#sortFilter").click(),$("#sortFilter").focus())});$("#categoryFilterSection #categoryFilter #viewallCategoriesContainer .viewAllLink").length>0?(limitFocusInDialog("#categoryFilterSection #categoryFilter #viewallCategoriesContainer .viewAllLink","a#toggleSidebar"),$("#homePageStickyThreadsContainer a").length>0?(limitFocusIfNoPop("#homePageStickyThreadsContainer .arrowoutercontainer:first a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter"),limitFocusInDialog("#homePageStickyThreadsContainer .arrowoutercontainer:first a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter input:last")):$("#homePageResultsContainer a").length>0?(limitFocusIfNoPop("#homePageResultsContainer .arrowoutercontainer:first a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter"),limitFocusInDialog("#homePageResultsContainer .arrowoutercontainer:first a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter input:last")):$("div#ux-footer a").length>0?(limitFocusIfNoPop("div#ux-footer a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter"),limitFocusInDialog("div#ux-footer a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter input:last")):(limitFocusIfNoPop("div#Footer a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter"),limitFocusInDialog("div#Footer a:first","#searchContent #homePageFilterBarContainer #filterBar #sortFilter input:last")),$("#searchActionsContainer #searchActions a").length>0?limitFocusInDialog("#searchActionsContainer #searchActions a:first","#homePageSidebarContainer #sidebar a:last"):limitFocusInDialog("#searchActionsContainer #searchActions .searchboxinnercontainer #searchbox","#homePageSidebarContainer #sidebar a:last"),limitFocusInDialog("#homePageContentContainer #searchContent #homePageFilterBarContainer #filterBar #threadFilter","#searchActionsContainer #searchActions .searchboxinnercontainer #searchimage")):(limitFocusInDialog("#threadPageSidebarContainer a:first","a#toggleSidebar"),limitFocusInDialog("#topBarImportantInfoContainer #relatedThreadsLinkContainer #relatedThreadsLink","#threadPageSidebarContainer a:last"),limitFocusInDialog("#threadPageContainer a#rssFeed","#searchActionsContainer #searchActions .searchboxinnercontainer #searchimage")),limitFocusInDialog("a#toggleSidebar","#quickActions #quickLinks a:last"),limitFocusIfNoPop("a#toggleSidebar","#quickActions #quickLinks");$("body").on("keydown",".forumDetailsTip a:last",function(n){n.shiftKey||n.which!=9||($(this).parents(".forumBreadcrumb").first().data("hover",0),$(this).parents(".forumDetailsTip").first().hide())});$(".logoSpan.clip67x13").attr("tabindex","-1"),addSkipNavigationButton();$("body").on("keydown","#HeaderSearchTextBox",function(n){n.which==9&&$("#searchTextContainer").is(":visible")&&(n.shiftKey?$(".toc ul.navL1").children("li").last().children("a").first().focus():$("#FakeHeaderSearchButton").focus(),n.preventDefault&&n.preventDefault())});$("body").on("keydown","#FakeHeaderSearchButton",function(n){n.which==9&&$("#searchTextContainer").is(":visible")&&(n.shiftKey?$("#HeaderSearchTextBox").focus():$("#askaquestion .askQuestionLink").focus(),n.preventDefault&&n.preventDefault())});$(".toc ul.navL1").children("li").last().children("a").first().keydown(function(n){!n.shiftKey&&n.which==9&&$("#searchTextContainer").is(":visible")&&$(this).next("ul").is(":hidden")&&($("#HeaderSearchTextBox").focus(),n.preventDefault&&n.preventDefault())});$("body").on("keydown","#askaquestion .askQuestionLink",function(n){n.shiftKey&&n.which==9&&$("#searchTextContainer").is(":visible")&&($("#FakeHeaderSearchButton").focus(),n.preventDefault&&n.preventDefault())})});var eventImgs=[],eventImgIdx=0;(function(){function f(n,t,i){var r=document.createElement("iframe");r.height=r.width=0,r.frameBorder=r.scrolling="no",r.src=n+"?signedin="+(t?t:"0")+"&r="+Math.floor(Math.random()*1e6),i&&(r.src+="&locale="+i),document.body.appendChild(r)}function n(){var n=document.cookie.match(new RegExp("\\b"+i+"=([^;]+)"));return n?n[1]:null}function u(t){var f=n(),u,r;f&&(u="&c="+t,r="&c=2",document.cookie=i+"="+f.replace(u,r)+";path=/")}function r(n){var t={};return n&&n.replace(/([^?=&]+)=([^&]*)?/g,function(n,i,r){t[i]=r}),t}var i="ssostate",t=window.onload;window.onload=function(){var i,o,e;if(t&&t(),i=r(n()),i.url&&i.c=="1")for(o=i.url.split(","),e=0;e<o.length;e++)o[e]&&f(unescape(o[e]),i.sig,i.loc);i.c&&(i.c=="0"||i.c=="1")&&u(i.c)}})(),$(function(){var t=$("div#TargetPanel"),n=$("div#PopupPanel"),i=0,r;positionPopup=function(){var t=$("div#LocaleFlyout");t.length==0&&(t=$("div#LocaleSelector")),n.css("left",t.position().left-(n.outerWidth()-t.outerWidth())),n.css("top",t.position().top+t.outerHeight())},showPanel=function(){positionPopup(),n.show(i),t.find("a:first").attr("aria-expanded",!0)},hidePanel=function(r){r!=undefined&&(n.hide(i),t.find("a:first").attr("aria-expanded",!1))},hidePopUpIfVisible=function(){n.css("display")=="block"&&t.click()},r=$(document),r.click(hidePopUpIfVisible),$(window).resize(hidePanel),n.hide(i),t.toggle(showPanel,hidePanel)})